---
owner_slack: "#modernisation-platform"
title: How to Rotate Secrets
last_reviewed_on: 2023-11-22
review_in: 6 months
---

# <%= current_page.data.title %>

## Introduction

We don't have many secrets on stored on the Modernisation Platform, but they are rotated regularly, every 180 days.

This guide advises where secrets are stored and how to rotate them.

| Name | Secret Name | Useage | Location | How to rotate | Days to rotate |
|---|---|---|---|---|---|
| Organisation Level PagerDuty Token | pagerduty_token | Used by PagerDuty Terraform to manage most PagerDuty resources|AWS Secrets Manager | Contact Operations Engineering to issue a new token and update the secret. | 180 |
| PagerDuty Modernisation Platform Team user | N/A | Used for dead-end notifications as all schedules need a user | Not stored | Use password reset process if needed | N/A |
| Slack Webhook URL | slack_webhook_url | Used to post alarms to Slack | AWS Secrets Manager | Contact Operations Engineeering to issue a new incoming webhook for the `Modernisation Platform Alerts` custom Slack application.  Revoke the old incoming webhook and update the secret. | 180 |
| GitHub MP CI User PAT | github_ci_user_pat | Used to create PRs etc in GitHub actions and deploy GitHub resources via Terraform | AWS Secrets Manager | Log in as the Modernisation Platform CI User and generate a new PAT, revoke the old one and update the secret. | 180 |
| GitHub MP CI User Environments Repo PAT | github_ci_user_environments_repo_pat | Used in reusable pipelines of the modernisation-platform-environments repository. This is so that the CI user can post comments in PRs, e.g. tf plan/apply output. | AWS Secrets Manager | Log in as the Modernisation Platform CI User and generate a new PAT, revoke the old one and update the secret.| 180 |
| GitHub MP CI User Password | github_ci_user_password | Used to log in and set the PAT | AWS Secrets Manager | Log in to GitHub as the user and reset the password, update the secret | 180 |
| Environment Management | environment_management | A Map of account names to IDs, and data for environment management, such as organizational unit IDs | Does not need rotating, not really a secret and regenerated on each account creation | N/A |
| Nuke ID List | nuke_account_ids | Account IDs to be auto-nuked on weekly basis. This secret is used by GitHub actions job nuke.yml inside the environments repo, to find the Account IDs to be nuked. |	Not really a secret, should not be rotated | N/A |
| Nuke Block List | nuke_account_blocklist | Account IDs to be excluded from auto-nuke. AWS-Nuke (https://github.com/rebuy-de/aws-nuke) requires at least one Account ID to be present in this blocklist, while it is recommended to add every production account to this blocklist. | Not really a secret, should not be rotated | N/A |
| PagerDuty user api | pagerduty_userapi_token | PagerDuty api user token | Log in as the Modernisation Platform CI User and generate a new PAT, revoke the old one and update the secret. | 180 |
| Circle CI ID | mod-platform-circleci | CircleCI organisation ID for ministryofjustice, used for OIDC IAM policies | Log in as the Modernisation Platform CI User and generate a new PAT, revoke the old one and update the secret. | N/A |
| ModernisationPlatformOrganisationManagement IAM user in MoJ root account | N/A | Used to perform limited activities in the root account. No longer used as replaced by OIDC but user kept for breakglass purposes. | Not stored | No active access keys, if keys or password needed contact Operations Engineering | N/A |
| Modernisation Platform Account Root User Password | N/A | Only used during initial platform set up, log in prevented via SCP and no password or keys set | Not stored | Disable or move account to a non SCP protected OU and follow the password reset steps | N/A |

There are multiple connections to PagerDuty (pagerduty_token and pagerduty_userapi_token) due to the way PagerDuty connects to slack. It requires an api token to get the organisations to allow the connection to slack.
If this changes in the future it may no longer be needed.